<%- include('../partials/header', { 
    title: 'Message Detail - Dr. Salmin Amour Sec. School',
    breadcrumbs: [
        { text: 'Contact', url: '/contact' },
        { text: 'Messages', url: '/contact/messages' },
        { text: 'Message Detail' }
    ]
}) %>

<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h4 class="mb-0">
                    <i class="fas fa-envelope me-2"></i>Message Details
                </h4>
                <div class="btn-group" role="group">
                    <a href="/contact/messages" class="btn btn-outline-secondary">
                        <i class="fas fa-arrow-left me-1"></i>Back to Messages
                    </a>
                    <form method="POST" action="/contact/messages/<%= message.id %>/delete" 
                          style="display: inline;" 
                          onsubmit="return confirm('Are you sure you want to delete this message?')">
                        <button type="submit" class="btn btn-outline-danger">
                            <i class="fas fa-trash me-1"></i>Delete
                        </button>
                    </form>
                </div>
            </div>
            <div class="card-body">
                <!-- Message Status -->
                <div class="mb-4">
                    <form method="POST" action="/contact/messages/<%= message.id %>/status" class="d-inline">
                        <div class="btn-group" role="group">
                            <input type="hidden" name="status" value="unread">
                            <button type="submit" class="btn btn-outline-warning <%= message.status === 'unread' ? 'active' : '' %>">
                                <i class="fas fa-envelope me-1"></i>Mark Unread
                            </button>
                        </div>
                    </form>
                    <form method="POST" action="/contact/messages/<%= message.id %>/status" class="d-inline">
                        <div class="btn-group" role="group">
                            <input type="hidden" name="status" value="read">
                            <button type="submit" class="btn btn-outline-info <%= message.status === 'read' ? 'active' : '' %>">
                                <i class="fas fa-envelope-open me-1"></i>Mark Read
                            </button>
                        </div>
                    </form>
                    <form method="POST" action="/contact/messages/<%= message.id %>/status" class="d-inline">
                        <div class="btn-group" role="group">
                            <input type="hidden" name="status" value="replied">
                            <button type="submit" class="btn btn-outline-success <%= message.status === 'replied' ? 'active' : '' %>">
                                <i class="fas fa-reply me-1"></i>Mark Replied
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Message Information -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label fw-bold">From:</label>
                            <div class="form-control-plaintext">
                                <i class="fas fa-user me-2"></i><%= message.name %>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-bold">Email:</label>
                            <div class="form-control-plaintext">
                                <i class="fas fa-envelope me-2"></i>
                                <a href="mailto:<%= message.email %>"><%= message.email %></a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label fw-bold">Date:</label>
                            <div class="form-control-plaintext">
                                <i class="fas fa-calendar me-2"></i>
                                <%= new Date(message.created_at).toLocaleDateString() %>
                                <br>
                                <small class="text-muted">
                                    <%= new Date(message.created_at).toLocaleTimeString() %>
                                </small>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-bold">Status:</label>
                            <div class="form-control-plaintext">
                                <% if (message.status === 'unread') { %>
                                    <span class="badge bg-warning">
                                        <i class="fas fa-envelope me-1"></i>Unread
                                    </span>
                                <% } else if (message.status === 'read') { %>
                                    <span class="badge bg-info">
                                        <i class="fas fa-envelope-open me-1"></i>Read
                                    </span>
                                <% } else if (message.status === 'replied') { %>
                                    <span class="badge bg-success">
                                        <i class="fas fa-reply me-1"></i>Replied
                                    </span>
                                <% } %>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Subject -->
                <div class="mb-4">
                    <label class="form-label fw-bold">Subject:</label>
                    <div class="form-control-plaintext">
                        <i class="fas fa-tag me-2"></i><%= message.subject %>
                    </div>
                </div>

                <!-- Message Content -->
                <div class="mb-4">
                    <label class="form-label fw-bold">Message:</label>
                    <div class="form-control-plaintext" style="min-height: 200px; white-space: pre-wrap;">
                        <%= message.message %>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="border-top pt-3">
                    <h6 class="mb-3">Quick Actions:</h6>
                    <div class="d-flex gap-2">
                        <a href="mailto:<%= message.email %>?subject=Re: <%= message.subject %>" 
                           class="btn btn-primary">
                            <i class="fas fa-reply me-1"></i>Reply via Email
                        </a>
                        <button class="btn btn-outline-secondary" onclick="window.print()">
                            <i class="fas fa-print me-1"></i>Print Message
                        </button>
                        <a href="/contact/messages" class="btn btn-outline-secondary">
                            <i class="fas fa-list me-1"></i>Back to List
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div> 